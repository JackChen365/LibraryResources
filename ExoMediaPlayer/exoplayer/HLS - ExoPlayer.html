<!DOCTYPE html>
<!-- saved from url=(0030)https://exoplayer.dev/hls.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!-- Global site tag (gtag.js) - Google Analytics -->
	<script type="text/javascript" async="" src="./HLS - ExoPlayer_files/analytics.js"></script><script async="" src="./HLS - ExoPlayer_files/js"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-68257324-1');
		
			gtag('config', 'UA-68257324-1', { 'anonymize_ip': true });
		
	</script>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"><title>HLS - ExoPlayer</title>

<meta name="description" content="An application level media player for Android">
<link rel="canonical" href="https://exoplayer.dev/hls.html"><link rel="alternate" type="application/rss+xml" title="ExoPlayer" href="https://exoplayer.dev/feed.xml"><!-- start favicons snippet, use https://realfavicongenerator.net/ --><link rel="apple-touch-icon" sizes="180x180" href="https://exoplayer.dev/assets/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://exoplayer.dev/assets/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://exoplayer.dev/assets/favicon-16x16.png"><link rel="manifest" href="https://exoplayer.dev/assets/site.webmanifest"><link rel="mask-icon" href="https://exoplayer.dev/assets/safari-pinned-tab.svg" color="#fc4d50"><link rel="shortcut icon" href="https://exoplayer.dev/assets/favicon.ico">

<meta name="msapplication-TileColor" content="#ffc40d"><meta name="msapplication-config" content="/assets/browserconfig.xml">

<meta name="theme-color" content="#ffffff">
<!-- end favicons snippet -->
<link rel="stylesheet" href="./HLS - ExoPlayer_files/main.css"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css"><!-- start custom head snippets -->
<style rel="stylesheet" type="text/css">
.gsc-result .gs-title {
  line-height: 1.4em;
}
</style>
<!-- end custom head snippets -->
<script>(function() {
  window.isArray = function(val) {
    return Object.prototype.toString.call(val) === '[object Array]';
  };
  window.isString = function(val) {
    return typeof val === 'string';
  };

  window.decodeUrl = function(str) {
    return str ? decodeURIComponent(str.replace(/\+/g, '%20')) : '';
  };

  window.hasEvent = function(event) {
    return 'on'.concat(event) in window.document;
  };

  window.isOverallScroller = function(node) {
    return node === document.documentElement || node === document.body || node === window;
  };

  window.isFormElement = function(node) {
    var tagName = node.tagName;
    return tagName === 'INPUT' || tagName === 'SELECT' || tagName === 'TEXTAREA';
  };

  window.pageLoad = (function () {
    var loaded = false, cbs = [];
    window.addEventListener('load', function () {
      var i;
      loaded = true;
      if (cbs.length > 0) {
        for (i = 0; i < cbs.length; i++) {
          cbs[i]();
        }
      }
    });
    return {
      then: function(cb) {
        cb && (loaded ? cb() : (cbs.push(cb)));
      }
    };
  })();
})();(function() {
  window.throttle = function(func, wait) {
    var args, result, thisArg, timeoutId, lastCalled = 0;

    function trailingCall() {
      lastCalled = new Date;
      timeoutId = null;
      result = func.apply(thisArg, args);
    }
    return function() {
      var now = new Date,
        remaining = wait - (now - lastCalled);

      args = arguments;
      thisArg = this;

      if (remaining <= 0) {
        clearTimeout(timeoutId);
        timeoutId = null;
        lastCalled = now;
        result = func.apply(thisArg, args);
      } else if (!timeoutId) {
        timeoutId = setTimeout(trailingCall, remaining);
      }
      return result;
    };
  };
})();(function() {
  var Set = (function() {
    var add = function(item) {
      var i, data = this._data;
      for (i = 0; i < data.length; i++) {
        if (data[i] === item) {
          return;
        }
      }
      this.size ++;
      data.push(item);
      return data;
    };

    var Set = function(data) {
      this.size = 0;
      this._data = [];
      var i;
      if (data.length > 0) {
        for (i = 0; i < data.length; i++) {
          add.call(this, data[i]);
        }
      }
    };
    Set.prototype.add = add;
    Set.prototype.get = function(index) { return this._data[index]; };
    Set.prototype.has = function(item) {
      var i, data = this._data;
      for (i = 0; i < data.length; i++) {
        if (this.get(i) === item) {
          return true;
        }
      }
      return false;
    };
    Set.prototype.is = function(map) {
      if (map._data.length !== this._data.length) { return false; }
      var i, j, flag, tData = this._data, mData = map._data;
      for (i = 0; i < tData.length; i++) {
        for (flag = false, j = 0; j < mData.length; j++) {
          if (tData[i] === mData[j]) {
            flag = true;
            break;
          }
        }
        if (!flag) { return false; }
      }
      return true;
    };
    Set.prototype.values = function() {
      return this._data;
    };
    return Set;
  })();

  window.Lazyload = (function(doc) {
    var queue = {js: [], css: []}, sources = {js: {}, css: {}}, context = this;
    var createNode = function(name, attrs) {
      var node = doc.createElement(name), attr;
      for (attr in attrs) {
        if (attrs.hasOwnProperty(attr)) {
          node.setAttribute(attr, attrs[attr]);
        }
      }
      return node;
    };
    var end = function(type, url) {
      var s, q, qi, cbs, i, j, cur, val, flag;
      if (type === 'js' || type ==='css') {
        s = sources[type], q = queue[type];
        s[url] = true;
        for (i = 0; i < q.length; i++) {
          cur = q[i];
          if (cur.urls.has(url)) {
            qi = cur, val = qi.urls.values();
            qi && (cbs = qi.callbacks);
            for (flag = true, j = 0; j < val.length; j++) {
              cur = val[j];
              if (!s[cur]) {
                flag = false;
              }
            }
            if (flag && cbs && cbs.length > 0) {
              for (j = 0; j < cbs.length; j++) {
                cbs[j].call(context);
              }
              qi.load = true;
            }
          }
        }
      }
    };
    var load = function(type, urls, callback) {
      var s, q, qi, node, i, cur,
        _urls = typeof urls === 'string' ? new Set([urls]) : new Set(urls), val, url;
      if (type === 'js' || type ==='css') {
        s = sources[type], q = queue[type];
        for (i = 0; i < q.length; i++) {
          cur = q[i];
          if (_urls.is(cur.urls)) {
            qi = cur;
            break;
          }
        }
        val = _urls.values();
        if (qi) {
          callback && (qi.load || qi.callbacks.push(callback));
          callback && (qi.load && callback());
        } else {
          q.push({
            urls: _urls,
            callbacks: callback ? [callback] : [],
            load: false
          });
          for (i = 0; i < val.length; i++) {
            node = null, url = val[i];
            if (s[url] === undefined) {
              (type === 'js' ) && (node = createNode('script', { src: url }));
              (type === 'css') && (node = createNode('link', { rel: 'stylesheet', href: url }));
              if (node) {
                node.onload = (function(type, url) {
                  return function() {
                    end(type, url);
                  };
                })(type, url);
                (doc.head || doc.body).appendChild(node);
                s[url] = false;
              }
            }
          }
        }
      }
    };
    return {
      js: function(url, callback) {
        load('js', url, callback);
      },
      css: function(url, callback) {
        load('css', url, callback);
      }
    };
  })(this.document);
})();</script><script>
  (function() {
    var TEXT_VARIABLES = {
      version: '2.2.4',
      sources: {
        font_awesome: 'https://use.fontawesome.com/releases/v5.0.13/css/all.css',
        jquery: 'https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js',
        leancloud_js_sdk: '//cdn1.lncld.net/static/js/3.4.1/av-min.js',
        chart: 'https://cdn.bootcss.com/Chart.js/2.7.2/Chart.bundle.min.js',
        gitalk: {
          js: 'https://cdn.bootcss.com/gitalk/1.2.2/gitalk.min.js',
          css: 'https://cdn.bootcss.com/gitalk/1.2.2/gitalk.min.css'
        },
        valine: 'https://unpkg.com/valine/dist/Valine.min.js',
        mathjax: 'https://cdn.bootcss.com/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML',
        mermaid: 'https://cdn.bootcss.com/mermaid/8.0.0-rc.8/mermaid.min.js'
      },
      site: {
        toc: {
          selectors: 'h1,h2,h3'
        }
      },
      paths: {
        search_js: '/assets/search.js'
      }
    };
    window.TEXT_VARIABLES = TEXT_VARIABLES;
  })();
</script><script src="./HLS - ExoPlayer_files/jquery.min.js"></script></head>
  <body>
    <div class="root" data-is-touch="false">
      <div class="layout--page layout--page--sidebar clearfix js-page-root">
  <div class="page__mask d-print-none js-page-mask js-sidebar-hide"></div>
  <div class="page__viewport">
    <div class="page__actions d-print-none">
      <div class="button button--circle button--lg box-shadow-2 sidebar-button js-sidebar-show">
        <i class="fas fa-bars icon--show"></i>
      </div>
    </div>

    <div class="grid page__grid">

      <div class="page__sidebar d-print-none"><div class="sidebar-toc"><ul class="toc toc--navigator"><li class="toc-h1"></li><li class="toc-h2"><a href="https://exoplayer.dev/">Home</a></li><li class="toc-h2"><a href="https://exoplayer.dev/pros-and-cons.html">Pros and cons</a></li><li class="toc-h2"><a href="https://exoplayer.dev/demo-application.html">Demo application</a></li><li class="toc-h2"><a href="https://exoplayer.dev/supported-formats.html">Supported formats</a></li><li class="toc-h2"><a href="https://exoplayer.dev/supported-devices.html">Supported devices</a></li><li class="toc-h2"><a href="https://exoplayer.dev/glossary.html">Glossary</a></li><li class="toc-h1">Getting started</li><li class="toc-h2"><a href="https://exoplayer.dev/hello-world.html">Hello world</a></li><li class="toc-h2"><a href="https://exoplayer.dev/listening-to-player-events.html">Listening to player events</a></li><li class="toc-h2"><a href="https://exoplayer.dev/media-sources.html">Media sources</a></li><li class="toc-h2"><a href="https://exoplayer.dev/playlists.html">Playlists</a></li><li class="toc-h2"><a href="https://exoplayer.dev/track-selection.html">Track selection</a></li><li class="toc-h2"><a href="https://exoplayer.dev/ui-components.html">UI components</a></li><li class="toc-h2"><a href="https://exoplayer.dev/downloading-media.html">Downloading media</a></li><li class="toc-h2"><a href="https://exoplayer.dev/ad-insertion.html">Ad insertion</a></li><li class="toc-h1">Media types</li><li class="toc-h2"><a href="https://exoplayer.dev/dash.html">DASH</a></li><li class="toc-h2 active"><a href="https://exoplayer.dev/hls.html">HLS</a></li><li class="toc-h2"><a href="https://exoplayer.dev/smoothstreaming.html">SmoothStreaming</a></li><li class="toc-h2"><a href="https://exoplayer.dev/progressive.html">Progressive</a></li><li class="toc-h1">Advanced topics</li><li class="toc-h2"><a href="https://exoplayer.dev/drm.html">Digital rights management</a></li><li class="toc-h2"><a href="https://exoplayer.dev/troubleshooting.html">Troubleshooting</a></li><li class="toc-h2"><a href="https://exoplayer.dev/customization.html">Customization</a></li><li class="toc-h2"><a href="https://exoplayer.dev/battery-consumption.html">Battery consumption</a></li><li class="toc-h2"><a href="https://exoplayer.dev/shrinking.html">APK shrinking</a></li><li class="toc-h2"><a href="https://exoplayer.dev/oems.html">OEM testing</a></li><li class="toc-h2"><a href="https://exoplayer.dev/design-documents.html">Design documents</a></li></ul></div></div><div class="page__main js-page-main cell cell--auto">

      <div class="page__main-inner"><div class="page__header d-print-none"><header class="header"><div class="main">
      <div class="header__title">
        <div class="header__brand"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 110 123.97"><defs><style>.cls-1{fill:none;}.cls-2{fill:#757576;}.cls-3{fill:#212120;}.cls-4{fill:#fff;}.cls-5{fill:#616262;}</style></defs><title>Asset 3</title><g id="Layer_2" data-name="Layer 2"><g id="Logo"><path class="cls-1" d="M59.57,47.36a2.21,2.21,0,0,0,0-.37V27.83l0,.07Z"></path><path class="cls-2" d="M17.24,47.77A13.08,13.08,0,1,1,37.16,31.38a12.7,12.7,0,0,1,1.51,4.14,2.82,2.82,0,0,0,3.77,2.07L59.57,27.7,13.73,1.23A9.1,9.1,0,0,0,.09,9.11V61.88l16.64-9.52A2.85,2.85,0,0,0,17.24,47.77Z"></path><path class="cls-2" d="M.28,61.93H.09l.09,0Z"></path><path class="cls-3" d="M38.65,88.62a13,13,0,0,1-2.39,5.43,13.09,13.09,0,1,1-19-17.79,2.83,2.83,0,0,0-.49-4.58L.09,62v52.82a9.1,9.1,0,0,0,13.64,7.88L59.48,96.33l-16.6-9.59A2.85,2.85,0,0,0,38.65,88.62Z"></path><polygon class="cls-3" points="0.09 61.93 0.09 62.04 0.18 61.98 0.09 61.93"></polygon><path class="cls-4" d="M55.87,74.39A13.09,13.09,0,1,1,50.33,49a12.94,12.94,0,0,1,5.55.68,2.82,2.82,0,0,0,3.69-2.33V27.9l0-.07h0l0,0V27.7L42.44,37.59a2.82,2.82,0,0,1-3.77-2.07,12.7,12.7,0,0,0-1.51-4.14A13.09,13.09,0,1,0,17.24,47.77a2.85,2.85,0,0,1-.51,4.59L.09,61.88l-.09,0H.28l-.1,0L.09,62l16.7,9.64a2.83,2.83,0,0,1,.49,4.58,13.08,13.08,0,1,0,19,17.79,13,13,0,0,0,2.39-5.43,2.85,2.85,0,0,1,4.23-1.88l16.6,9.59.09,0V76.72A2.82,2.82,0,0,0,55.87,74.39Z"></path><path class="cls-5" d="M105.45,54.16,59.62,27.7h0v.13h0V47a2.21,2.21,0,0,1,0,.37,2.82,2.82,0,0,1-3.69,2.33A12.94,12.94,0,0,0,50.33,49a13.08,13.08,0,1,0,5.54,25.38,2.82,2.82,0,0,1,3.7,2.33,2.21,2.21,0,0,1,0,.37V96.38h0l45.83-26.46A9.1,9.1,0,0,0,105.45,54.16Z"></path></g></g></svg><a title="An application level media player for Android" href="https://exoplayer.dev/">ExoPlayer</a></div><button class="button button--secondary button--circle search-button js-search-toggle"><i class="fas fa-search"></i></button></div><nav class="navigation">
        <ul><li class="navigation__item"><a href="https://exoplayer.dev/doc/reference/" target="_blank" rel="noopener noreferrer">Javadoc</a></li><li class="navigation__item"><a href="https://github.com/google/ExoPlayer" target="_blank" rel="noopener noreferrer">GitHub</a></li><li class="navigation__item"><a href="https://medium.com/google-exoplayer" target="_blank" rel="noopener noreferrer">Blog</a></li><li><button class="button button--secondary button--circle search-button js-search-toggle"><i class="fas fa-search"></i></button></li></ul>
      </nav></div>
  </header>
</div><div class="page__content"><div class="main"><div class="grid grid--reverse">

              <div class="col-aside d-print-none js-col-aside"></div>

              <div class="col-main cell cell--auto"><!-- start custom main top snippet -->

<!-- end custom main top snippet --><article itemscope="" itemtype="http://schema.org/Article"><div class="article__header"><header><h1>HLS</h1></header></div><meta itemprop="headline" content="HLS"><meta itemprop="author" content="ExoPlayer"><div class="js-article-content"><div class="layout--article"><!-- start custom article top snippet -->

<!-- end custom article top snippet --><div class="article__content" itemprop="articleBody"><p>ExoPlayer supports HLS with multiple container formats. The contained audio and
video sample formats must also be supported (see the
<a href="https://exoplayer.dev/supported-formats.html#sample-formats">sample formats</a> section for details). We
strongly encourage HLS content producers to generate high quality HLS streams,
as described
<a href="https://medium.com/google-exoplayer/hls-playback-in-exoplayer-a33959a47be7">here</a>.</p>

<table>
  <thead>
    <tr>
      <th>Feature</th>
      <th style="text-align: center">Supported</th>
      <th style="text-align: left">Comment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Containers</strong></td>
      <td style="text-align: center">&nbsp;</td>
      <td style="text-align: left">&nbsp;</td>
    </tr>
    <tr>
      <td>MPEG-TS</td>
      <td style="text-align: center">YES</td>
      <td style="text-align: left">&nbsp;</td>
    </tr>
    <tr>
      <td>FMP4/CMAF</td>
      <td style="text-align: center">YES</td>
      <td style="text-align: left">&nbsp;</td>
    </tr>
    <tr>
      <td>ADTS (AAC)</td>
      <td style="text-align: center">YES</td>
      <td style="text-align: left">&nbsp;</td>
    </tr>
    <tr>
      <td>MP3</td>
      <td style="text-align: center">YES</td>
      <td style="text-align: left">&nbsp;</td>
    </tr>
    <tr>
      <td><strong>Closed&nbsp;captions/subtitles</strong></td>
      <td style="text-align: center">&nbsp;</td>
      <td style="text-align: left">&nbsp;</td>
    </tr>
    <tr>
      <td>CEA-608</td>
      <td style="text-align: center">YES</td>
      <td style="text-align: left">&nbsp;</td>
    </tr>
    <tr>
      <td>WebVTT</td>
      <td style="text-align: center">YES</td>
      <td style="text-align: left">&nbsp;</td>
    </tr>
    <tr>
      <td><strong>Metadata</strong></td>
      <td style="text-align: center">&nbsp;</td>
      <td style="text-align: left">&nbsp;</td>
    </tr>
    <tr>
      <td>ID3 metadata</td>
      <td style="text-align: center">YES</td>
      <td style="text-align: left">&nbsp;</td>
    </tr>
    <tr>
      <td><strong>Content protection</strong></td>
      <td style="text-align: center">&nbsp;</td>
      <td style="text-align: left">&nbsp;</td>
    </tr>
    <tr>
      <td>AES-128</td>
      <td style="text-align: center">YES</td>
      <td style="text-align: left">&nbsp;</td>
    </tr>
    <tr>
      <td>Sample AES-128</td>
      <td style="text-align: center">NO</td>
      <td style="text-align: left">&nbsp;</td>
    </tr>
    <tr>
      <td>Widevine</td>
      <td style="text-align: center">YES</td>
      <td style="text-align: left">API 19+ (“cenc” scheme) and 25+ (“cbcs” scheme)</td>
    </tr>
    <tr>
      <td>PlayReady SL2000</td>
      <td style="text-align: center">YES</td>
      <td style="text-align: left">Android TV only</td>
    </tr>
  </tbody>
</table>

<h2 id="creating-a-mediasource">Creating a MediaSource</h2>

<p>To play an HLS stream, create an <code class="language-plaintext highlighter-rouge">HlsMediaSource</code> and prepare the player with
it as usual.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Create a data source factory.</span>
<span class="nc">DataSource</span><span class="o">.</span><span class="na">Factory</span> <span class="n">dataSourceFactory</span> <span class="o">=</span>
    <span class="k">new</span> <span class="nf">DefaultHttpDataSourceFactory</span><span class="o">(</span><span class="nc">Util</span><span class="o">.</span><span class="na">getUserAgent</span><span class="o">(</span><span class="n">context</span><span class="o">,</span> <span class="s">"app-name"</span><span class="o">));</span>
<span class="c1">// Create a HLS media source pointing to a playlist uri.</span>
<span class="nc">HlsMediaSource</span> <span class="n">hlsMediaSource</span> <span class="o">=</span>
    <span class="k">new</span> <span class="nc">HlsMediaSource</span><span class="o">.</span><span class="na">Factory</span><span class="o">(</span><span class="n">dataSourceFactory</span><span class="o">).</span><span class="na">createMediaSource</span><span class="o">(</span><span class="n">uri</span><span class="o">);</span>
<span class="c1">// Create a player instance.</span>
<span class="nc">SimpleExoPlayer</span> <span class="n">player</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SimpleExoPlayer</span><span class="o">.</span><span class="na">Builder</span><span class="o">(</span><span class="n">context</span><span class="o">).</span><span class="na">build</span><span class="o">();</span>
<span class="c1">// Prepare the player with the media source.</span>
<span class="n">player</span><span class="o">.</span><span class="na">prepare</span><span class="o">(</span><span class="n">hlsMediaSource</span><span class="o">);</span>
</code></pre></div></div>

<p>The URI passed to <code class="language-plaintext highlighter-rouge">HlsMediaSource.Factory.createMediaSource()</code> may point to
either a media playlist or a master playlist. If the URI points to a master
playlist that declares multiple <code class="language-plaintext highlighter-rouge">#EXT-X-STREAM-INF</code> tags then ExoPlayer will
automatically adapt between variants, taking into account both available
bandwidth and device capabilities.</p>

<h2 id="accessing-the-manifest">Accessing the manifest</h2>

<p>You can retrieve the current manifest by calling <code class="language-plaintext highlighter-rouge">Player.getCurrentManifest</code>.
For HLS you should cast the returned object to <code class="language-plaintext highlighter-rouge">HlsManifest</code>. The
<code class="language-plaintext highlighter-rouge">onTimelineChanged</code> callback of <code class="language-plaintext highlighter-rouge">Player.EventListener</code> is also called whenever
the manifest is loaded. This will happen once for a on-demand content, and
possibly many times for live content. The code snippet below shows how an app
can do something whenever the manifest is loaded.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">player</span><span class="o">.</span><span class="na">addListener</span><span class="o">(</span>
    <span class="k">new</span> <span class="nc">Player</span><span class="o">.</span><span class="na">EventListener</span><span class="o">()</span> <span class="o">{</span>
      <span class="nd">@Override</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onTimelineChanged</span><span class="o">(</span>
          <span class="nc">Timeline</span> <span class="n">timeline</span><span class="o">,</span> <span class="nd">@Player</span><span class="o">.</span><span class="na">TimelineChangeReason</span> <span class="kt">int</span> <span class="n">reason</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Object</span> <span class="n">manifest</span> <span class="o">=</span> <span class="n">player</span><span class="o">.</span><span class="na">getCurrentManifest</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">manifest</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
          <span class="nc">HlsManifest</span> <span class="n">hlsManifest</span> <span class="o">=</span> <span class="o">(</span><span class="nc">HlsManifest</span><span class="o">)</span> <span class="n">manifest</span><span class="o">;</span>
          <span class="c1">// Do something with the manifest.</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">});</span>
</code></pre></div></div>

<h2 id="customizing-hls-playback">Customizing HLS playback</h2>

<p>ExoPlayer provides multiple ways for you to tailor playback experience to your
app’s needs. The following sections briefly document some of the customization
options available when building a <code class="language-plaintext highlighter-rouge">HlsMediaSource</code>. See the
<a href="https://exoplayer.dev/customization.html">Customization page</a> for more general customization options.</p>

<h3 id="enabling-faster-start-up-times">Enabling faster start-up times</h3>

<p>You can improve HLS start up times noticeably by enabling chunkless preparation.
When you enable chunkless preparation and <code class="language-plaintext highlighter-rouge">#EXT-X-STREAM-INF</code> tags contain the
<code class="language-plaintext highlighter-rouge">CODECS</code> attribute, ExoPlayer will avoid downloading media segments as part of
preparation. The following snippet shows how to enable chunkless preparation:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">HlsMediaSource</span> <span class="n">hlsMediaSource</span> <span class="o">=</span>
    <span class="k">new</span> <span class="nc">HlsMediaSource</span><span class="o">.</span><span class="na">Factory</span><span class="o">(</span><span class="n">dataSourceFactory</span><span class="o">)</span>
        <span class="o">.</span><span class="na">setAllowChunklessPreparation</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
        <span class="o">.</span><span class="na">createMediaSource</span><span class="o">(</span><span class="n">hlsUri</span><span class="o">);</span>
</code></pre></div></div>

<p>You can find more details in our <a href="https://medium.com/google-exoplayer/faster-hls-preparation-f6611aa15ea6">Medium post about chunkless preparation</a>.</p>

<h3 id="customizing-server-interactions">Customizing server interactions</h3>

<p>Some apps may want to intercept HTTP requests and responses. You may want to
inject custom request headers, read the server’s response headers, modify the
requests’ URIs, etc. For example, your app may authenticate itself by injecting
a token as a header when requesting the media segments.</p>

<p>The following example demonstrates how to implement these behaviors by
injecting custom <a href="https://exoplayer.dev/doc/reference/com/google/android/exoplayer2/upstream/HttpDataSource.html">HttpDataSources</a> into an <code class="language-plaintext highlighter-rouge">HlsMediaSource</code>:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">HlsMediaSource</span> <span class="n">hlsMediaSource</span> <span class="o">=</span>
    <span class="k">new</span> <span class="nc">HlsMediaSource</span><span class="o">.</span><span class="na">Factory</span><span class="o">(</span>
            <span class="n">dataType</span> <span class="o">-&gt;</span> <span class="o">{</span>
              <span class="nc">HttpDataSource</span> <span class="n">dataSource</span> <span class="o">=</span>
                  <span class="k">new</span> <span class="nf">DefaultHttpDataSource</span><span class="o">(</span><span class="n">userAgent</span><span class="o">);</span>
              <span class="k">if</span> <span class="o">(</span><span class="n">dataType</span> <span class="o">==</span> <span class="no">C</span><span class="o">.</span><span class="na">DATA_TYPE_MEDIA</span><span class="o">)</span> <span class="o">{</span>
                <span class="c1">// The data source will be used for fetching media segments. We</span>
                <span class="c1">// set a custom authentication request header.</span>
                <span class="n">dataSource</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"Header"</span><span class="o">,</span> <span class="s">"Value"</span><span class="o">);</span>
              <span class="o">}</span>
              <span class="k">return</span> <span class="n">dataSource</span><span class="o">;</span>
            <span class="o">})</span>
        <span class="o">.</span><span class="na">createMediaSource</span><span class="o">(</span><span class="n">hlsUri</span><span class="o">);</span>
</code></pre></div></div>

<p>In the code snippet above, the injected <code class="language-plaintext highlighter-rouge">HttpDataSource</code> includes the header
<code class="language-plaintext highlighter-rouge">"Header: Value"</code> in every HTTP request triggered by <code class="language-plaintext highlighter-rouge">hlsMediaSource</code>. This
behavior is <em>fixed</em> for every interaction of <code class="language-plaintext highlighter-rouge">hlsMediaSource</code> with an HTTP
source.</p>

<p>For a more granular approach, you can inject just-in-time behavior using a
<code class="language-plaintext highlighter-rouge">ResolvingDataSource</code>. The following code snippet shows how to inject
request headers just before interacting with an HTTP source:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">HlsMediaSource</span> <span class="n">hlsMediaSource</span> <span class="o">=</span>
    <span class="k">new</span> <span class="nc">HlsMediaSource</span><span class="o">.</span><span class="na">Factory</span><span class="o">(</span>
        <span class="k">new</span> <span class="nc">ResolvingDataSource</span><span class="o">.</span><span class="na">Factory</span><span class="o">(</span>
            <span class="k">new</span> <span class="nf">DefaultHttpDataSourceFactory</span><span class="o">(</span><span class="n">userAgent</span><span class="o">),</span>
            <span class="c1">// Provide just-in-time request headers.</span>
            <span class="o">(</span><span class="nc">DataSpec</span> <span class="n">dataSpec</span><span class="o">)</span> <span class="o">-&gt;</span>
                <span class="n">dataSpec</span><span class="o">.</span><span class="na">withRequestHeaders</span><span class="o">(</span><span class="n">getCustomHeaders</span><span class="o">(</span><span class="n">dataSpec</span><span class="o">.</span><span class="na">uri</span><span class="o">))))</span>
        <span class="o">.</span><span class="na">createMediaSource</span><span class="o">(</span><span class="n">customSchemeUri</span><span class="o">);</span>
</code></pre></div></div>

<p>You may also use a <code class="language-plaintext highlighter-rouge">ResolvingDataSource</code>  to perform
just-in-time modifications of the URI, as shown in the following snippet:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">HlsMediaSource</span> <span class="n">hlsMediaSource</span> <span class="o">=</span>
    <span class="k">new</span> <span class="nc">HlsMediaSource</span><span class="o">.</span><span class="na">Factory</span><span class="o">(</span>
        <span class="k">new</span> <span class="nc">ResolvingDataSource</span><span class="o">.</span><span class="na">Factory</span><span class="o">(</span>
            <span class="k">new</span> <span class="nf">DefaultHttpDataSourceFactory</span><span class="o">(</span><span class="n">userAgent</span><span class="o">),</span>
            <span class="c1">// Provide just-in-time URI resolution logic.</span>
            <span class="o">(</span><span class="nc">DataSpec</span> <span class="n">dataSpec</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">dataSpec</span><span class="o">.</span><span class="na">withUri</span><span class="o">(</span><span class="n">resolveUri</span><span class="o">(</span><span class="n">dataSpec</span><span class="o">.</span><span class="na">uri</span><span class="o">))))</span>
        <span class="o">.</span><span class="na">createMediaSource</span><span class="o">(</span><span class="n">customSchemeUri</span><span class="o">);</span>
</code></pre></div></div>

<h3 id="customizing-error-handling">Customizing error handling</h3>

<p>Implementing a custom <a href="https://exoplayer.dev/doc/reference/com/google/android/exoplayer2/upstream/LoadErrorHandlingPolicy.html">LoadErrorHandlingPolicy</a> allows apps to customize the
way ExoPlayer reacts to load errors. For example, an app may want fail fast
instead of retrying many times, or may want to customize the back-off logic that
controls how long the player waits between each retry. The following snippet
shows how to implement custom back-off logic when creating a <code class="language-plaintext highlighter-rouge">HlsMediaSource</code>:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">HlsMediaSource</span> <span class="n">hlsMediaSource</span> <span class="o">=</span>
    <span class="k">new</span> <span class="nc">HlsMediaSource</span><span class="o">.</span><span class="na">Factory</span><span class="o">(</span><span class="n">dataSourceFactory</span><span class="o">)</span>
        <span class="o">.</span><span class="na">setLoadErrorHandlingPolicy</span><span class="o">(</span>
            <span class="k">new</span> <span class="nf">DefaultLoadErrorHandlingPolicy</span><span class="o">()</span> <span class="o">{</span>
              <span class="nd">@Override</span>
              <span class="kd">public</span> <span class="kt">long</span> <span class="nf">getRetryDelayMsFor</span><span class="o">(...)</span> <span class="o">{</span>
                <span class="c1">// Implement custom back-off logic here.</span>
              <span class="o">}</span>
            <span class="o">})</span>
        <span class="o">.</span><span class="na">createMediaSource</span><span class="o">(</span><span class="n">hlsUri</span><span class="o">);</span>
</code></pre></div></div>

<p>You will find more information in our <a href="https://medium.com/google-exoplayer/load-error-handling-in-exoplayer-488ab6908137">Medium post about error handling</a>.</p>

<h2 id="creating-high-quality-hls-content">Creating high quality HLS content</h2>

<p>In order to get the most out of ExoPlayer, there are certain guidelines you can
follow to improve your HLS content. Read our <a href="https://medium.com/google-exoplayer/hls-playback-in-exoplayer-a33959a47be7">Medium post about HLS playback in
ExoPlayer</a> for a full explanation. The main points are:</p>

<ul>
  <li>Use precise segment durations.</li>
  <li>Use a continues media stream; avoid changes in the media structure across
segments.</li>
  <li>Use the <code class="language-plaintext highlighter-rouge">#EXT-X-INDEPENDENT-SEGMENTS</code> tag.</li>
  <li>Prefer demuxed streams, as opposed to files that include both video and audio.</li>
  <li>Include all information you can in the Master Playlist.</li>
</ul>

<p>The following guidelines apply specifically for live streams:</p>

<ul>
  <li>Use the <code class="language-plaintext highlighter-rouge">#EXT-X-PROGRAM-DATE-TIME</code> tag.</li>
  <li>Use the <code class="language-plaintext highlighter-rouge">#EXT-X-DISCONTINUITY-SEQUENCE</code> tag.</li>
  <li>Provide a long live window. One minute or more is great.</li>
</ul>

<h2 id="behindlivewindowexception">BehindLiveWindowException</h2>

<p>In case a live stream with limited availability is played, the player may fall
behind this live window if the player is paused or buffering for a long enough
period of time. In this case a <code class="language-plaintext highlighter-rouge">BehindLiveWindowException</code> is thrown, which can
be caught to resume the player at the live edge. The <a href="https://github.com/google/ExoPlayer/tree/release-v2/demos/main/src/main/java/com/google/android/exoplayer2/demo/PlayerActivity.java">PlayerActivity</a> of the
demo app exemplifies this approach.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">onPlayerError</span><span class="o">(</span><span class="nc">ExoPlaybackException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">isBehindLiveWindow</span><span class="o">(</span><span class="n">e</span><span class="o">))</span> <span class="o">{</span>
    <span class="c1">// Re-initialize player at the live edge.</span>
  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
    <span class="c1">// Handle other errors</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">isBehindLiveWindow</span><span class="o">(</span><span class="nc">ExoPlaybackException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">type</span> <span class="o">!=</span> <span class="nc">ExoPlaybackException</span><span class="o">.</span><span class="na">TYPE_SOURCE</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="nc">Throwable</span> <span class="n">cause</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">getSourceException</span><span class="o">();</span>
  <span class="k">while</span> <span class="o">(</span><span class="n">cause</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">cause</span> <span class="k">instanceof</span> <span class="nc">BehindLiveWindowException</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="n">cause</span> <span class="o">=</span> <span class="n">cause</span><span class="o">.</span><span class="na">getCause</span><span class="o">();</span>
  <span class="o">}</span>
  <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

</div><div class="d-print-none"><footer class="article__footer"><!-- start custom article footer snippet -->

<!-- end custom article footer snippet --></footer><div class="article__section-navigator clearfix"><div class="previous"><span>PREVIOUS</span><a href="https://exoplayer.dev/dash.html">DASH</a></div><div class="next"><span>NEXT</span><a href="https://exoplayer.dev/smoothstreaming.html">SmoothStreaming</a></div></div></div>

</div>

<script>(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    $(function() {
      var $this ,$scroll;
      var $articleContent = $('.js-article-content');
      var hasSidebar = $('.js-page-root').hasClass('layout--page--sidebar');
      var scroll = hasSidebar ? '.js-page-main' : 'html, body';
      $scroll = $(scroll);

      $articleContent.find('.highlight').each(function() {
        $this = $(this);
        $this.attr('data-lang', $this.find('code').attr('data-lang'));
      });
      $articleContent.find('h1[id], h2[id], h3[id], h4[id], h5[id], h6[id]').each(function() {
        $this = $(this);
        $this.append($('<a class="anchor d-print-none" aria-hidden="true"></a>').html('<i class="fas fa-anchor"></i>'));
      });
      $articleContent.on('click', '.anchor', function() {
        $scroll.scrollToAnchor('#' + $(this).parent().attr('id'), 400);
      });
    });
  });
})();</script></div><section class="page__comments d-print-none"></section></article><!-- start custom main bottom snippet -->

<!-- end custom main bottom snippet --></div>
            </div></div></div><div class="page__footer d-print-none">
<footer class="footer py-4 js-page-footer">
  <div class="main"><div itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ExoPlayer"><meta itemprop="url" content="/"><div class="footer__author-links"><div class="author-links">
  <ul class="menu menu--nowrap menu--inline"><li title="Follow us on Medium.">
        <a class="button button--circle medium-button" itemprop="sameAs" href="https://medium.com/google-exoplayer" target="_blank" rel="noopener noreferrer">
          <div class="icon"><svg fill="#000000" width="24px" height="24px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M834.7 279.8l61.3-58.9V208H683.7L532.4 586.4 360.3 208H137.7v12.9l71.6 86.6c7 6.4 10.6 15.8 9.7 25.2V673c2.2 12.3-1.7 24.8-10.3 33.7L128 805v12.7h228.6v-12.9l-80.6-98a39.99 39.99 0 0 1-11.1-33.7V378.7l200.7 439.2h23.3l172.6-439.2v349.9c0 9.2 0 11.1-6 17.2l-62.1 60.3V819h301.2v-12.9l-59.9-58.9c-5.2-4-7.9-10.7-6.8-17.2V297a18.1 18.1 0 0 1 6.8-17.2z"></path>
</svg></div>
        </a>
      </li><li title="Follow us on Github.">
        <a class="button button--circle github-button" itemprop="sameAs" href="https://github.com/google/ExoPlayer" target="_blank" rel="noopener noreferrer">
          <div class="icon"><svg fill="#000000" width="24px" height="24px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path class="svgpath" data-index="path_0" fill="#272636" d="M0 525.2c0 223.6 143.3 413.7 343 483.5 26.9 6.8 22.8-12.4 22.8-25.4l0-88.7c-155.3 18.2-161.5-84.6-172-101.7-21.1-36-70.8-45.2-56-62.3 35.4-18.2 71.4 4.6 113.1 66.3 30.2 44.7 89.1 37.2 119 29.7 6.5-26.9 20.5-50.9 39.7-69.6C248.8 728.2 181.7 630 181.7 513.2c0-56.6 18.7-108.7 55.3-150.7-23.3-69.3 2.2-128.5 5.6-137.3 66.5-6 135.5 47.6 140.9 51.8 37.8-10.2 80.9-15.6 129.1-15.6 48.5 0 91.8 5.6 129.8 15.9 12.9-9.8 77-55.8 138.8-50.2 3.3 8.8 28.2 66.7 6.3 135 37.1 42.1 56 94.6 56 151.4 0 117-67.5 215.3-228.8 243.7 26.9 26.6 43.6 63.4 43.6 104.2l0 128.8c0.9 10.3 0 20.5 17.2 20.5C878.1 942.4 1024 750.9 1024 525.3c0-282.9-229.3-512-512-512C229.1 13.2 0 242.3 0 525.2L0 525.2z"></path>
</svg>
</div>
        </a>
      </li></ul>
</div>
</div>
    </div><div class="site-info mt-2">
      <div>© ExoPlayer 2019,
        Powered by <a title="Jekyll is a simple, blog-aware, static site generator." href="http://jekyllrb.com/">Jekyll</a> &amp; <a title="TeXt is a super customizable Jekyll theme." href="https://github.com/kitian616/jekyll-TeXt-theme">TeXt Theme</a>.
      </div>
    </div>
  </div>
</footer></div></div>
    </div></div></div><script></script></div></div></body></html>